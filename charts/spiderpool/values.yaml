# Default values for spiderpool.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

rbac:
  # -- Enable creation of Resource-Based Access Control configuration.
  create: true

# default spiderpool
nameOverride: ""

configMap:
  name: spiderpool

## @param commonAnnotations Annotations to add to all deployed objects
##
commonAnnotations: {}
#  annotation1: v1
#  annotation2: v2

## @param commonLabels Labels to add to all deployed objects
##
commonLabels: {}
#  label1: v1
#  labele: v2

# example CA cert, and expiry time is 100 years
# encoded
ca:
  cert: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQyakNDQXNLZ0F3SUJBZ0lVQU54QVU4S1FFWkxReUVBakMzTk5vSStCeWRvd0RRWUpLb1pJaHZjTkFRRUwKQlFBd2N6RUxNQWtHQTFVRUJoTUNWVk14RmpBVUJnTlZCQWdURFZOaGJpQkdjbUZ1WTJselkyOHhDekFKQmdOVgpCQWNUQWtOQk1SWXdGQVlEVlFRS0V3MTNaV3hoYmlCamIyMXdZVzU1TVJNd0VRWURWUVFMRXdwUGNtY2dWVzVwCmRDQXhNUkl3RUFZRFZRUURFd2x6Y0dsa1pYSnVaWFF3SGhjTk1qSXdOakF4TVRVeE1qQXdXaGNOTWpjd05UTXgKTVRVeE1qQXdXakJ6TVFzd0NRWURWUVFHRXdKVlV6RVdNQlFHQTFVRUNCTU5VMkZ1SUVaeVlXNWphWE5qYnpFTApNQWtHQTFVRUJ4TUNRMEV4RmpBVUJnTlZCQW9URFhkbGJHRnVJR052YlhCaGJua3hFekFSQmdOVkJBc1RDazl5Clp5QlZibWwwSURFeEVqQVFCZ05WQkFNVENYTndhV1JsY201bGREQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQUQKZ2dFUEFEQ0NBUW9DZ2dFQkFLWW5ybGhyWFRlOUxjUWUxNWsrY01TNWFIRzM0S2loV2tJdEptVlRoU3NGSzkwQwpVRUlyTnpSVHAyQTVFRDhBUWVnU0JLQWcyT3lSUUxmcERJWWFzZ0wrTkF1RkxQT0FSQ2gzc0FXWUZJVkYwOGo3CklxL2dzMmFpZUpBWis4cmozWVFSSEN4bGx6Vnh2Tk1URDlScU1ZMFZzdWNwOXVRUTZxdUdRemNId2NFN2VQSjMKQW1QRndaUzdVcXY0all5MVc3R3ZxdDlvMVdubHBHeFJrbzhnbm4rcnM4NlJ2YWQxZ21nTE9jTG9sRHpMRHRzTwpNdHhLaGdBbEx2dE95bkxLZjdMc21DREhBTUVBaVdzRG5weDJnOGw5dXJkZlRxMHZBOUdwaXlnZkNpc05PdGloCmpPWWM5dy9xcGJtbXMvZU91ZGNJakVpYWN5cEEwNEE3bitZZ0JrVUNBd0VBQWFObU1HUXdEZ1lEVlIwUEFRSC8KQkFRREFnRUdNQklHQTFVZEV3RUIvd1FJTUFZQkFmOENBUUl3SFFZRFZSME9CQllFRk9FZDlucFRSeld4aEl2RwozWXlFdmZXYUNwZ21NQjhHQTFVZEl3UVlNQmFBRk9FZDlucFRSeld4aEl2RzNZeUV2ZldhQ3BnbU1BMEdDU3FHClNJYjNEUUVCQ3dVQUE0SUJBUUJreW11V2FvZE5keVREODE1SWMyQ0krSzFuSHJuWFNPL2w0VURlQVBsMUlwMC8KUTR6YTJYOEVUNCtPYUc1ZXAxcWxJb1hzb2F4bjJaLy90T0lYNmtGcDdDNzR6dzFqSDdyUmo0YTAxbDlIRmZYMgpsQWsxcXRIQ2VwK2VZbmcvTDdvZk8weU03NE5sWXpPWVhHV0lnUCtaYUFyQlZ1NDhMTmNxZEUxZDg1N2hOYWRnCmZLTGUwOGRRV0pTUC9UNERudnI1YnNFN2EzTDZweTUzcGw2YjM5ZFBZYnRCQ0ZsTlR1UXFwaUcwKysvNSt2S1cKdXVyTUVyWFJXcmNWMkcvUFhkbXBlOEJtK0VWcWI4VXFtNEtCcGtVdGtwL2IwRmNieDBBSnl5aU1oSG9iaGtUKwpkdlk3MWdOUXdWSEFUa2o4emVkRklTWXVOaFJjYXZYb3o1d3c3U2NwCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K"
  key: "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBcGlldVdHdGRONzB0eEI3WG1UNXd4TGxvY2JmZ3FLRmFRaTBtWlZPRkt3VXIzUUpRClFpczNORk9uWURrUVB3QkI2QklFb0NEWTdKRkF0K2tNaGhxeUF2NDBDNFVzODRCRUtIZXdCWmdVaFVYVHlQc2kKcitDelpxSjRrQm43eXVQZGhCRWNMR1dYTlhHODB4TVAxR294alJXeTV5bjI1QkRxcTRaRE53ZkJ3VHQ0OG5jQwpZOFhCbEx0U3EvaU5qTFZic2ErcTMyalZhZVdrYkZHU2p5Q2VmNnV6enBHOXAzV0NhQXM1d3VpVVBNc08ydzR5CjNFcUdBQ1V1KzA3S2NzcC9zdXlZSU1jQXdRQ0phd09lbkhhRHlYMjZ0MTlPclM4RDBhbUxLQjhLS3cwNjJLR00KNWh6M0QrcWx1YWF6OTQ2NTF3aU1TSnB6S2tEVGdEdWY1aUFHUlFJREFRQUJBb0lCQUU0MnE2bFBrT2ZtRTU4WQpiYURqZGE0RklSYzIyWGhIeS9jT3pkNHd2S1VOb0NJL0xveVhUenRBamErTDdRdmJFU3N2SUNKSWxCUjRJNkR2CkFVZzNWTWgzNVFQdlFzTzFBMkNSUnJpN2FCMThTejkyaUZPR1VLemxtaDhyUEEyN3lkQ2JSVW5ZNEo3MTFVNysKMEJyTGlsdkJkUisvNzBwWWREOGR5cElqQXAvMG5xMEtGUWVxdCt0djI4a1h4RDhGVlpHK1FuYlRPY3NnNGxhKwpYMS9Qb0xCbmVBRVdBRFVuV21JVUZ1K3dhb1JpbnA1dUZBc2ZmY1lLWVlDb09RRG1jZ2dCdjd6dUZhVDZXbDZkCjhBUjZWbEFzbTU2eTBoVXo2NmQ5U0R1cWFTQ2M2VWJFNlQxV0QveWdkcklacDJZRWdIYmdQRnNpR3lETkVjTnMKNFdoK0hRRUNnWUVBeC9FN3AzZVJoMVMwM1BkMEVCbmgzMHE2RnFCQW5yMWk5VnhqRnlXclpaTlp3TjNZa0FBMApjR2QvSU93S0lVemZCNkJxZXpoMWlOYjhYbHFvRGZqeE50bmpINWtpSm1TcmZUYnNZQjZMa3daVVllLzZHSkR0Cjh3YUxKYVcrU0lpMDR2N29MMTBHSzRtaFVtNTFOWW03alQ0c1VvODZhZVZKeUFNbzdxK0YrU1VDZ1lFQTFMMWgKSEluc0NWYlFZT0traXhGVFZ3amdJb0NaY2ljTmpQV3JqRFM5UTJsc043NmFJZHc3MENiMnpiNEhpaitnRHRyTwpVUU9scGdBTWZSYk51VnoxZmFNbWMwZWR5M0xCQjR4bDJ5emtHSjlyOTNKUmdVSkNqVnJGQ3lyQ2tiWTE4STZTCjZVOEIzMTVBaU8zQXBHdkVqSHJaSEpwRkE5bjNWc1FSTlU4OEhxRUNnWUJoK2ptRVdCaHRXN29CYWhWcTZuUUEKQ3N0ajJRV3hoQmJoSzNPM1hSTS9oRlNBS1hZOUlveVA1SGVzdDE1RGNUcjlyc05mUEl5RUVPMjhndXBGWm84MQpsTkl5b3NUVVVaS2ptbTE4c0pzdTRmUXB4Z0lsVmFmMDVtajdldHZqQ1hLeXBiMDdzSGNja0tZSUVlN0gzSVdXCnNqZmdBU1hiektzNkl5cEV4S2gvTFFLQmdRQ2s0RUVyUlJsU0E1NXIrRHRlTElkU3BPWlExeW9WZG43aUNHUnoKdlV3UnV0ck1PVVJyaWF3eG5vRVk0M1lraHpzZFNDY3VVbzFISWpLTG4rakJDSEthZEorUUtLajZ6RzBkMUluOApXOFpMN3dKV1BKcytlb1BwMmJkcytDN2pqend1dTlEUVVSTTZjbW5CdGNIZnJFWWdPZldhWFZXdnJuWXJJTG5WCmZ4c3hBUUtCZ0c0SFZTbCt4RXppVlI2ZC9tK3JVVkFNVTVvUmYvZTlTMk5aelBtazZhYi83cUkyVFRYa1piOGkKa09DOWp1TkdLc1RFTDNWZGxJZHh3RStCTGFXMEEvdzdPQUY3Rkhyc2w2M2J4YzZjV04vd1hRTTV2azRLMnNlcwovbEJSQmY3VlBrWTBFNW5IQTJEbERrUlRXUlNQVHZpS0hyZkU0bzlUQzJtSytqYm44RjJnCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg=="

ipamPlugin:
  # -- Configure the log file for IPAM
  log_file_path: /var/run/spidernet/spiderpool.log
  log_file_max_size: 100M
  log_file_max_age: 30d
  log_file_max_count: 7
  log_level: "INFO"

  # -- Configure the path to the configuration directory on the host.
  confPath: /etc/cni/net.d/spiderpool

  binPath: /opt/cni/bin

  # -- Configure the path to the binary directory on the host.
  ipamBinPath: /opt/cni/bin

  # -- Configure the unix socket path to connect with the spiderpool agent.
  ipam_unix_socket_dir: /var/run/spidernet
  ipam_unix_socket_path: /var/run/spidernet/spiderpool.sock

configmap:
  configCmName: "spiderpool-conf"
  config:
    # -- Unix domain socket path to listen for ipam plugin.
    ipamUnixSocketPath: "/var/run/spidernet/spiderpool.sock"
    enableIpv4: true
    enableIpv6: true
    clusterDefaultIpv4Ippool: []
    clusterDefaultIpv6Ippool: []
    networkMode: "legacy"

spiderpoolAgent:
  name: "spiderpool-agent"

  binName: "spiderpool-agent"

  image:
    repository: ghcr.io/spidernet-io/spiderpool/spiderpool-agent
    pullPolicy: IfNotPresent
    # take preference over tag
    digest: ""
    # Overrides the image tag whose default is the chart appVersion.
    tag: ""
    imagePullSecrets: []
    # - name: "image-pull-secret"

  nodeSelector:
    kubernetes.io/os: linux

  nameOverride: ""

  serviceAccount:
    create: true
    annotations: {}

  updateStrategy:
    rollingUpdate:
      maxUnavailable: 2
    type: RollingUpdate

  service:
    # Optional annotations to add to the Service
    annotations: {}
    type: ClusterIP

  # -- Node tolerations
  # ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
    - effect: NoSchedule
      key: node.kubernetes.io/disk-pressure
      operator: Exists
    - effect: NoSchedule
      key: node.kubernetes.io/memory-pressure
      operator: Exists
    - effect: NoSchedule
      key: node.kubernetes.io/pid-pressure
      operator: Exists
    - effect: NoSchedule
      key: node.kubernetes.io/unschedulable
      operator: Exists
    - effect: NoSchedule
      key: node.kubernetes.io/network-unavailable
      operator: Exists
    - key: node.kubernetes.io/not-ready
      effect: NoSchedule
    - key: node-role.kubernetes.io/master
      effect: NoSchedule
    - key: CriticalAddonsOnly
      operator: Exists

  priorityClassName: ""

  affinity: {}

  # -- Additional container arguments.
  extraArgs: []

  # -- Additional container environment variables.
  extraEnv: []

  # -- Additional agent hostPath mounts.
  extraHostPathMounts: []
    # - name: host-mnt-data
    #   mountPath: /host/mnt/data
    #   hostPath: /mnt/data
    #   hostPathType: Directory
    #   readOnly: true
    #   mountPropagation: HostToContainer

  # -- Additional agent volumes.
  extraVolumes: []

  # -- Additional agent volumeMounts.
  extraVolumeMounts: []

  # -- Annotations to be added to agent pods
  podAnnotations: {}

  # -- Labels to be added to agent pods
  podLabels: {}

  # -- Configure the path to where to mount the ConfigMap inside the agent pod.
  confFileMountPath: /tmp/cni-configuration

  resources: {}
    # We usually recommend not to specify default resources and to leave this as a conscious
    # choice for the user. This also increases chances charts run on environments with little
    # resources, such as Minikube. If you do want to specify resources, uncomment the following
    # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
    # limits:
    #   cpu: 1000m
    #   memory: 512Mi
    # requests:
    #   cpu: 100m
    #   memory: 128Mi

  # -- Security context to be added to agent pods
  securityContext: {}
  # runAsUser: 0

  # -- Configure the path to where the CNI configuration directory is mounted
  # inside the agent pod.
  hostConfDirMountPath: /host/etc/cni/net.d/spiderpool

  # -- http Port for health checking
  httpPort: "5710"

  healthChecking:
    startupProbe:
      # -- failure threshold of startup probe.
      # 105 x 2s translates to the old behaviour of the readiness probe (120s delay + 30 x 3s)
      failureThreshold: 60
      # -- interval between checks of the startup probe
      periodSeconds: 2

    livenessProbe:
      # -- failure threshold of liveness probe
      failureThreshold: 6
      # -- interval between checks of the liveness probe
      periodSeconds: 10

    readinessProbe:
      # -- failure threshold of readiness probe
      failureThreshold: 3
      # -- interval between checks of the readiness probe
      periodSeconds: 10

  # -- Enable prometheus metrics for cilium-operator on the configured port at
  # /metrics
  prometheus:
    # -- Enable service monitors.
    # This requires the prometheus CRDs to be available (see https://github.com/prometheus-operator/prometheus-operator/blob/master/example/prometheus-operator-crd/monitoring.coreos.com_servicemonitors.yaml)
    enabled: false
    port: 5711
    serviceMonitor:
      labels: {}
      annotations: {}
    prometheusRule:
      # enable alter rules
      enabled: false

  debug:
    logLevel: "INFO"
    pprofEnabled: false

spiderpoolController:
  name: "spiderpool-controller"

  replicas: 1

  binName: "spiderpool-controller"

  # ippool is not installed when installation , so have to be hostnetwork
  hostnetwork: true

  nameOverride: ""

  image:
    repository: ghcr.io/spidernet-io/spiderpool/spiderpool-controller
    pullPolicy: IfNotPresent
    # take preference over tag
    digest: ""
    # digest: "sha256:251ff274acf22fd2067b29a31e9fda94253d2961c061577203621583d7e85bd2"
    # Overrides the image tag whose default is the chart appVersion.
    tag: ""
    imagePullSecrets: []
    # - name: "image-pull-secret"

  nodeSelector:
    kubernetes.io/os: linux

  affinity: {}

  serviceAccount:
    create: true
    name: ""
    annotations: {}

  service:
    # Optional annotations to add to the Service
    annotations: {}
    type: ClusterIP

  tolerations:
    - key: CriticalAddonsOnly
      operator: Exists
    - effect: NoSchedule
      key: node-role.kubernetes.io/master
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300

  priorityClassName: ""

  # -- Additional container arguments.
  extraArgs: []

  # -- Additional container environment variables.
  extraEnv: []

  # -- Additional agent hostPath mounts.
  extraHostPathMounts: []
    # - name: host-mnt-data
    #   mountPath: /host/mnt/data
    #   hostPath: /mnt/data
    #   hostPathType: Directory
    #   readOnly: true
  #   mountPropagation: HostToContainer

  # -- Additional agent volumes.
  extraVolumes: []
    # - name: test-val
    #   mountPath: /host/tmp

  # -- Additional agent volumeMounts.
  extraVolumeMounts: []
    # - name: test-val
    #   mountPath: /tmp

  # -- Annotations to be added to agent pods
  podAnnotations: {}
    # test: 100

  # -- Labels to be added to agent pods
  podLabels: {}

  # -- security context
  securityContext: {}
  # runAsUser: 0

  resources:
    # We usually recommend not to specify default resources and to leave this as a conscious
    # choice for the user. This also increases chances charts run on environments with little
    # resources, such as Minikube. If you do want to specify resources, uncomment the following
    # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

  # -- http Port to listen to for CLI and health checking
  httpPort: "5720"

  # PodDisruptionBudget settings
  podDisruptionBudget:
    # -- enable PodDisruptionBudget
    # ref: https://kubernetes.io/docs/concepts/workloads/pods/disruptions/
    enabled: false
    # -- Minimum number/percentage of pods that should remain scheduled.
    # When it's set, maxUnavailable must be disabled by `maxUnavailable: null`
    minAvailable: 1
    # -- Maximum number/percentage of pods that may be made unavailable
   # maxUnavailable: 1

  healthChecking:
    startupProbe:
      # -- failure threshold of startup probe.
      # 105 x 2s translates to the old behaviour of the readiness probe (120s delay + 30 x 3s)
      failureThreshold: 30
      # -- interval between checks of the startup probe
      periodSeconds: 2

    livenessProbe:
      # -- failure threshold of liveness probe
      failureThreshold: 6
      # -- interval between checks of the liveness probe
      periodSeconds: 10

    readinessProbe:
      # -- failure threshold of readiness probe
      failureThreshold: 3
      # -- interval between checks of the readiness probe
      periodSeconds: 10

  # -- Enable prometheus metrics for cilium-operator on the configured port at
  # /metrics
  prometheus:
    enabled: false
    port: 5721
    serviceMonitor:
      # -- Enable service monitors.
      # This requires the prometheus CRDs to be available (see https://github.com/prometheus-operator/prometheus-operator/blob/master/example/prometheus-operator-crd/monitoring.coreos.com_servicemonitors.yaml)
      enabled: false
      labels: {}
      annotations: {}
    prometheusRule:
      # enable alter rules
      enabled: false

  debug:
    logLevel: "INFO"
    pprofEnabled: false

  gc:
    # global enable
    enabled: true
    # if enabled=false, ignore this
    gcTerminatingPodIpEnabled: true
    # delay to gc pod ip after pod graceful time, second
    gcTerminatingPodIpDelay: 0
    # if enabled=false, ignore this
    gcEvictedPodIpEnabled: true
    # delay to gc pod ip after pod graceful time, second
    gcEvictedPodIpDelay: 0

  # -- TLS configuration for webhook
  tls:
    # -- Set the method to auto-generate certificates. Supported values:
    # - helm:         This method uses Helm to generate all certificates.
    # - provided:     provide all certificates by helm options
    # - certmanager:  This method use cert-manager to generate & rotate certificates.
    method: provided

    # -- Generated certificates validity duration in days.
    certValidityDuration: 1095

    # If not specified, a CA issuer will be created.
    # used by method certmanager
    certManagerIssuerName: ""

    # -- base64 encoded PEM values for the Hubble server certificate and private key
    server:
      # used by method provided
      # encoded
      cert: ""
      key: ""
      # -- Extra DNS names added to certificate when it's auto generated
      extraDnsNames: []
      # -- Extra IP addresses added to certificate when it's auto generated
      extraIpAddresses: []
